import{b as f,r as h,l as W,c as r,o as S,d as q,e as y,f as e,w as t,m as X,t as z,i as N,h as m,F as Y,n as Z,A as v,B as V,E as T,z as ee,q as le}from"./index-d2e98233.js";const ae={class:"menu-manager"},te={class:"query-form"},oe={class:"base-table"},ne={class:"action"},ue=y("span",null,"不选，则直接创建一级菜单",-1),de={class:"dialog-footer"},se={__name:"Menu",setup(re){const U=f(),g=f(),E=h([{label:"菜单名称",prop:"menuName",width:150},{label:"图标",prop:"icon"},{label:"菜单类型",prop:"menuType",formatter(n,l,u){return{1:"菜单",2:"按钮"}[u]}},{label:"权限标识",prop:"menuCode"},{label:"路由地址",prop:"path"},{label:"组件路径",prop:"component"},{label:"菜单状态",prop:"menuState",width:90,formatter(n,l,u){return{1:"正常",2:"停用"}[u]}},{label:"创建时间",prop:"createTime",formatter(n,l,u){return X.utc2beijing(u)}}]),c=h({menuState:1}),o=h({parentId:[null],menuType:1,menuState:1}),L={menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:10,message:"长度在2-8个字符",trigger:"blur"}]},p=f(!1),i=f("add"),_=f("添加"),k=f([]),b=async()=>{const n={...z(c)},l=await N.menuList(n);k.value=l};W(()=>{b()});const R=()=>{i.value="add",_.value="添加",p.value=!0},j=n=>{o.parentId=[...n.parentId,n._id].filter(l=>l),i.value="add",_.value="添加",p.value=!0},A=n=>{},D=()=>{b()},x=n=>{p.value=!1,C(n)};function O(n){n.validate(l=>{if(l){const u={...z(o)};u.action=i.value,u.parentId||(u.parentId=[null]),N.menuSubmit(u).then(d=>{T.success(_.value+"菜单成功!"),p.value=!1,C(n),b()})}else T.error("校验表单失败")})}const C=n=>{n.resetFields()},Q=n=>{i.value="edit",_.value=i.value==="add"?"增加":"编辑",p.value=!0,ee(()=>{Object.assign(o,n)})};function G(n){i.value="delete",_.value="删除";const l={_id:n,action:i.value};N.menuSubmit(l).then(u=>{T.success("成功删除菜单!"),b()})}return(n,l)=>{const u=r("el-input"),d=r("el-form-item"),I=r("el-option"),H=r("el-select"),s=r("el-button"),F=r("el-form"),M=r("el-table-column"),J=r("el-table"),K=r("el-cascader"),w=r("el-radio"),$=r("el-radio-group"),P=r("el-dialog");return S(),q("div",ae,[y("div",te,[e(F,{inline:"",model:c,ref_key:"formRef",ref:U},{default:t(()=>[e(d,{label:"菜单名称",prop:"menuName"},{default:t(()=>[e(u,{modelValue:c.menuName,"onUpdate:modelValue":l[0]||(l[0]=a=>c.menuName=a),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),e(d,{label:"菜单状态",prop:"menuState"},{default:t(()=>[e(H,{modelValue:c.menuState,"onUpdate:modelValue":l[1]||(l[1]=a=>c.menuState=a)},{default:t(()=>[e(I,{value:1,label:"正常"}),e(I,{value:2,label:"停用"})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(s,{type:"primary",onClick:D},{default:t(()=>[m("查询")]),_:1}),e(s,{onClick:l[2]||(l[2]=a=>{C(U.value),b()})},{default:t(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),y("div",oe,[y("div",ne,[e(s,{type:"primary",onClick:R},{default:t(()=>[m("创建菜单")]),_:1})]),e(J,{"row-key":"_id","tree-props":{children:"children"},data:k.value,style:{width:"100%"},onSelectionChange:A},{default:t(()=>[(S(!0),q(Y,null,Z(E,a=>(S(),le(M,{key:a.prop,prop:a.prop,label:a.label,width:a.width,formatter:a.formatter},null,8,["prop","label","width","formatter"]))),128)),e(M,{fixed:"right",label:"操作",width:"200"},{default:t(a=>[e(s,{onClick:B=>j(a.row),type:"primary",size:"small"},{default:t(()=>[m("新增")]),_:2},1032,["onClick"]),e(s,{size:"small",onClick:B=>Q(a.row)},{default:t(()=>[m("编辑")]),_:2},1032,["onClick"]),e(s,{disabled:a.row.state===2,type:"danger",onClick:B=>G(a.row._id),size:"small"},{default:t(()=>[m("删除")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"])]),e(P,{title:_.value+"菜单",modelValue:p.value,"onUpdate:modelValue":l[13]||(l[13]=a=>p.value=a),"before-close":()=>{x(g.value)}},{footer:t(()=>[y("span",de,[e(s,{onClick:l[11]||(l[11]=a=>x(g.value))},{default:t(()=>[m("取消")]),_:1}),e(s,{type:"primary",onClick:l[12]||(l[12]=a=>O(g.value))},{default:t(()=>[m("确定")]),_:1})])]),default:t(()=>[e(F,{ref_key:"dialogForm",ref:g,model:o,"label-width":"100px",rules:L},{default:t(()=>[e(d,{label:"父级菜单",prop:"parentId"},{default:t(()=>[e(K,{modelValue:o.parentId,"onUpdate:modelValue":l[3]||(l[3]=a=>o.parentId=a),options:k.value,props:{checkStrictly:!0,value:"_id",label:"menuName"},clearable:""},null,8,["modelValue","options"]),ue]),_:1}),e(d,{label:"菜单类型",prop:"menuType"},{default:t(()=>[e($,{modelValue:o.menuType,"onUpdate:modelValue":l[4]||(l[4]=a=>o.menuType=a)},{default:t(()=>[e(w,{label:1},{default:t(()=>[m("菜单")]),_:1}),e(w,{label:2},{default:t(()=>[m("按钮")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"菜单名称",prop:"menuName"},{default:t(()=>[e(u,{modelValue:o.menuName,"onUpdate:modelValue":l[5]||(l[5]=a=>o.menuName=a),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),v(e(d,{label:"菜单图标",prop:"icon"},{default:t(()=>[e(u,{modelValue:o.icon,"onUpdate:modelValue":l[6]||(l[6]=a=>o.icon=a),placeholder:"请输入菜单图标"},null,8,["modelValue"])]),_:1},512),[[V,o.menuType==1]]),v(e(d,{label:"路由地址",prop:"path"},{default:t(()=>[e(u,{modelValue:o.path,"onUpdate:modelValue":l[7]||(l[7]=a=>o.path=a),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1},512),[[V,o.menuType==1]]),v(e(d,{label:"权限标识",prop:"menuCode"},{default:t(()=>[e(u,{modelValue:o.menuCode,"onUpdate:modelValue":l[8]||(l[8]=a=>o.menuCode=a),placeholder:"请输入权限标识"},null,8,["modelValue"])]),_:1},512),[[V,o.menuType==2]]),v(e(d,{label:"组件路径",prop:"component"},{default:t(()=>[e(u,{modelValue:o.component,"onUpdate:modelValue":l[9]||(l[9]=a=>o.component=a),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1},512),[[V,o.menuType==1]]),v(e(d,{label:"菜单状态",prop:"menuState"},{default:t(()=>[e($,{modelValue:o.menuState,"onUpdate:modelValue":l[10]||(l[10]=a=>o.menuState=a)},{default:t(()=>[e(w,{label:1},{default:t(()=>[m("正常")]),_:1}),e(w,{label:2},{default:t(()=>[m("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[V,o.menuType==1]])]),_:1},8,["model"])]),_:1},8,["title","modelValue","before-close"])])}}};export{se as default};
